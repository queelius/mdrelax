# mdrelax

Relaxed Candidate Set Models for Masked Data in Series Systems

## Overview

This R package implements likelihood-based inference for series systems
with masked failure data when traditional conditions are relaxed. It
extends the standard C1-C2-C3 framework by allowing:

- **Informative masking (relaxed C2):** Candidate set probabilities can
  depend on which component failed
- **Parameter-dependent masking (relaxed C3):** Masking mechanism can
  depend on system parameters
- **Flexible candidate set models:** Bernoulli, rank-based, and
  KL-divergence constrained models

## Installation

``` r
# Install from GitHub
remotes::install_github("queelius/mdrelax")
```

## Key Features

- Maximum likelihood estimation for exponential and Weibull series
  systems
- Fisher information matrix computation for efficiency analysis
- Informative masking models (rank-based, KL-constrained)
- Identifiability analysis tools
- Simulation utilities for Monte Carlo studies

## Quick Start

``` r
library(mdrelax)

# Generate masked data with Bernoulli candidate sets
md <- md_bernoulli_cand_C1_C2_C3(data, p = 0.3)

# Sample candidate sets
md <- md_cand_sampler(md)

# Compute MLE for exponential series system
fit <- md_mle_exp_series_C1_C2_C3(md)

# Get Fisher information matrix
fim <- md_fim_exp_series_C1_C2_C3(md, params(fit))
```

## Background

In series systems with masked failure data: - The system fails when any
component fails - The failed component is not directly observed - A
*candidate set* of possible failed components is reported

Traditional analysis assumes: - **C1:** Failed component is always in
the candidate set - **C2:** Non-informative masking (uniform probability
within candidate set) - **C3:** Masking independent of system parameters

This package provides tools for inference when C2 and/or C3 are
violated.

## Documentation

See the [package website](https://queelius.github.io/mdrelax/) for full
documentation.

## Related Work

- [wei.series.md.c1.c2.c3](https://github.com/queelius/wei.series.md.c1.c2.c3) -
  Original implementation for Weibull series systems under C1-C2-C3

## License

GPL (\>= 3)

# Package index

## All functions

- [`generate_relaxed_cand_C1()`](https://queelius.github.io/mdrelax/reference/generate_relaxed_cand_C1.md)
  : generate_relaxed_cand_C1
- [`informative_masking_by_rank()`](https://queelius.github.io/mdrelax/reference/informative_masking_by_rank.md)
  : informative_masking_by_rank
- [`kl_divergence_bernoulli()`](https://queelius.github.io/mdrelax/reference/kl_divergence_bernoulli.md)
  : kl_divergence_bernoulli
- [`md_bernoulli_cand_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_bernoulli_cand_C1_C2_C3.md)
  : md_bernoulli_cand_C1_C2_C3
- [`md_bernoulli_cand_C1_kld()`](https://queelius.github.io/mdrelax/reference/md_bernoulli_cand_C1_kld.md)
  : md_bernoulli_cand_C1_kld
- [`md_block_candidate_m3()`](https://queelius.github.io/mdrelax/reference/md_block_candidate_m3.md)
  : md_block_candidate_m3
- [`md_cand_sampler()`](https://queelius.github.io/mdrelax/reference/md_cand_sampler.md)
  : md_cand_sampler
- [`md_exp_series_system_bernoulli_cand_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_exp_series_system_bernoulli_cand_C1_C2_C3.md)
  : Generate masked data for exponential series system (C1,C2,C3)
- [`md_fim_exp_series_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_fim_exp_series_C1_C2_C3.md)
  : Observed Fisher information matrix for exponential series system
  (C1,C2,C3)
- [`md_loglike_exp_series_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_loglike_exp_series_C1_C2_C3.md)
  : Log-likelihood function for exponential series system with masked
  data (C1,C2,C3)
- [`md_mle_exp_series_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_mle_exp_series_C1_C2_C3.md)
  : Maximum likelihood estimator for exponential series system
  (C1,C2,C3)
- [`md_score_exp_series_C1_C2_C3()`](https://queelius.github.io/mdrelax/reference/md_score_exp_series_C1_C2_C3.md)
  : Score function (gradient of log-likelihood) for exponential series
  system (C1,C2,C3)
- [`md_series_component_failure_probability_C1_C2()`](https://queelius.github.io/mdrelax/reference/md_series_component_failure_probability_C1_C2.md)
  : Component failure probability under conditions C1 and C2
- [`md_series_lifetime_right_censoring()`](https://queelius.github.io/mdrelax/reference/md_series_lifetime_right_censoring.md)
  : Decorate masked data with series system lifetime and right-censoring

# Articles

### All vignettes

- [Exponential Series Systems with Masked
  Data](https://queelius.github.io/mdrelax/articles/example-use.md):
